---
import { profileConfig } from "../config";
import { url } from "../utils/url-utils";

const currentYear = new Date().getFullYear();

// 注意：Astro 构建时是 Node.js 环境，可用 process.env
const deployPlatform = import.meta.env.SSR 
  ? (process.env.DEPLOY_PLATFORM ?? 'unknown') 
  : 'unknown'; // 前端 fallback（但页脚通常 SSR，所以主要看 SSR 分支）
---

<div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-32"></div>

<div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-6">
  <div class="transition text-50 text-sm text-center">
    &copy; <span id="copyright-year">{currentYear}</span> {profileConfig.name}. All Rights Reserved. /
    <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('rss.xml')}>RSS</a> /
    <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('sitemap-index.xml')}>Sitemap</a><br>
    Powered by
    <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> &
    <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/saicaca/fuwari">Fuwari</a><br>
    <a class="transition link text-[var(--primary)] font-medium inline-flex items-center" href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">
      <img alt="" src="/favicon/foot-icp.png" class="h-4 mr-1">粤ICP备2025509722号-1
    </a>

    <!-- 条件渲染平台标识 -->
    {deployPlatform === 'cloudflare' && (
      <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
        国际站 · Powered by Cloudflare
      </p>
    )}
    {deployPlatform === 'aliyun' && (
      <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
        中国站 · Powered by Aliyun ESA
      </p>
    )}
    {deployPlatform === 'edgeone' && (
      <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
        中国站 · Powered by Tecent EdgeOne
      </p>
    )}
  </div>
</div>